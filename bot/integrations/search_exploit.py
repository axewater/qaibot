import sys
import argparse
import json
import requests
from bs4 import BeautifulSoup

def search_exploitdb(query):
    url = f"https://www.exploit-db.com/search?q={query}"
    response = requests.get(url)
    soup = BeautifulSoup(response.text, "html.parser")

    results = []
    for tr in soup.find_all("tr"):
        tds = tr.find_all("td")
        if len(tds) == 5:
            exploit_id = tds[0].text.strip()
            description = tds[1].text.strip()
            date = tds[2].text.strip()
            author = tds[3].text.strip()
            platform = tds[4].text.strip()
            results.append({
                "id": exploit_id,
                "description": description,
                "date": date,
                "author": author,
                "platform": platform
            })

    return json.dumps(results, indent=2)

def main():
    parser = argparse.ArgumentParser(description="Search Exploit Database")
    parser.add_argument("query", help="Search query")

    args = parser.parse_args()

    results = search_exploitdb(args.query)
    print(results)

if __name__ == "__main__":
    main()