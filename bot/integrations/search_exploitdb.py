import argparse
import json
from pyExploitDbwindowscompatible.pyExploitDb import PyExploitDb

def search_exploitdb(query="Test"):
    pEdb = PyExploitDb()
    pEdb.debug = False
    pEdb.openFile()

    if query:
        results = pEdb.searchCve(query)
    else:
        results = []

    return json.dumps(results, indent=2)

def main():
    parser = argparse.ArgumentParser(description="Search the Exploit Database.")
    parser.add_argument("-q", "--query", help="Search query (required)")
    args = parser.parse_args()

    if args.query:
        results = search_exploitdb(args.query)
        print(results)
    else:
        parser.print_usage()

if __name__ == "__main__":
    main()
